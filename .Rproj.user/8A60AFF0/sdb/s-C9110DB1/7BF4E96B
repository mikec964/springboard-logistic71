{
    "collab_server" : "",
    "contents" : "## Regression with binary outcomes\n## ═════════════════════════════════\n\n## Logistic regression\n## ───────────────────────\n\n##   This far we have used the `lm' function to fit our regression models.\n##   `lm' is great, but limited–in particular it only fits models for\n##   continuous dependent variables. For categorical dependent variables we\n##   can use the `glm()' function.\n\n##   For these models we will use a different dataset, drawn from the\n##   National Health Interview Survey. From the [CDC website]:\n\n##         The National Health Interview Survey (NHIS) has monitored\n##         the health of the nation since 1957. NHIS data on a broad\n##         range of health topics are collected through personal\n##         household interviews. For over 50 years, the U.S. Census\n##         Bureau has been the data collection agent for the National\n##         Health Interview Survey. Survey results have been\n##         instrumental in providing data to track health status,\n##         health care access, and progress toward achieving national\n##         health objectives.\n\n##   Load the National Health Interview Survey data:\n\nNH11 <- readRDS(\"dataSets/NatHealth2011.rds\")\nlabs <- attributes(NH11)$labels\n\n##   [CDC website] http://www.cdc.gov/nchs/nhis.htm\n\n## Logistic regression example\n## ───────────────────────────────\n\n##   Let's predict the probability of being diagnosed with hypertension\n##   based on age, sex, sleep, and bmi\n\nstr(NH11$hypev) # check stucture of hypev\nlevels(NH11$hypev) # check levels of hypev\n# collapse all missing values to NA\nNH11$hypev <- factor(NH11$hypev, levels=c(\"2 No\", \"1 Yes\"))\n# run our regression model\nhyp.out <- glm(hypev~age_p+sex+sleep+bmi,\n              data=NH11, family=\"binomial\")\ncoef(summary(hyp.out))\n\n## Logistic regression coefficients\n## ────────────────────────────────────\n\n##   Generalized linear models use link functions, so raw coefficients are\n##   difficult to interpret. For example, the age coefficient of .06 in the\n##   previous model tells us that for every one unit increase in age, the\n##   log odds of hypertension diagnosis increases by 0.06. Since most of us\n##   are not used to thinking in log odds this is not too helpful!\n\n##   One solution is to transform the coefficients to make them easier to\n##   interpret\n\nhyp.out.tab <- coef(summary(hyp.out))\nhyp.out.tab[, \"Estimate\"] <- exp(coef(hyp.out))\nhyp.out.tab\n\n## Generating predicted values\n## ───────────────────────────────\n\n##   In addition to transforming the log-odds produced by `glm' to odds, we\n##   can use the `predict()' function to make direct statements about the\n##   predictors in our model. For example, we can ask \"How much more likely\n##   is a 63 year old female to have hypertension compared to a 33 year old\n##   female?\".\n\n# Create a dataset with predictors set at desired levels\npredDat <- with(NH11,\n                expand.grid(age_p = c(33, 63),\n                            sex = \"2 Female\",\n                            bmi = mean(bmi, na.rm = TRUE),\n                            sleep = mean(sleep, na.rm = TRUE)))\n# predict hypertension at those levels\ncbind(predDat, predict(hyp.out, type = \"response\",\n                       se.fit = TRUE, interval=\"confidence\",\n                       newdata = predDat))\n\n##   This tells us that a 33 year old female has a 13% probability of\n##   having been diagnosed with hypertension, while and 63 year old female\n##   has a 48% probability of having been diagnosed.\n\n## Packages for  computing and graphing predicted values\n## ─────────────────────────────────────────────────────────\n\n##   Instead of doing all this ourselves, we can use the effects package to\n##   compute quantities of interest for us (cf. the Zelig package).\n\nlibrary(effects)\nplot(allEffects(hyp.out))\n\n## Exercise: logistic regression\n## ───────────────────────────────────\n\n##   Use the NH11 data set that we loaded earlier.\n\n##   1. Use glm to conduct a logistic regression to predict ever worked\n##      (everwrk) using age (age_p) and marital status (r_maritl).\n##   2. Predict the probability of working for each level of marital\n##      status.\n\n##   Note that the data is not perfectly clean and ready to be modeled. You\n##   will need to clean up at least some of the variables before fitting\n##   the model.\n",
    "created" : 1527639188212.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3537291276",
    "id" : "7BF4E96B",
    "lastKnownWriteTime" : 1461791266,
    "last_content_update" : 1461791266,
    "path" : "~/dev/data science/logistic regression/logistic_regression/logistic_regression.R",
    "project_path" : "logistic_regression.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}